---
title: "Lab 1"
author: "Kitty Chen"
date: "2/9/2021"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(RMySQL)
db <- dbConnect(
  MySQL(),
  host = "scidb.smith.edu",
  user = "sds192",
  password = "DSismfc@S",
  dbname = "imdb"
)
knitr::opts_chunk$set(connection = db, max.print = 20)
```

```{r}
class(db)
```

```{sql connection = db, max.print = 20}
SELECT * FROM kind_type;
```
```{sql connection=db, max.print = 20, output.var = "info_types"}
SELECT * FROM info_type;
```

```{r}
head(info_types)
```
```{sql connection = db}
SELECT *
FROM title
WHERE title = 'The Empire Strikes Back';
```
That retrieved a lot of movies! Let’s see if we can refine our query. First, movies (as opposed to TV episodes, etc.) have the kind_id value of 1.

```{sql connection = db}
SELECT * 
FROM title 
WHERE title = 'The Empire Strikes Back' 
AND kind_id = 1;
```
Huh. Now we don’t get any results at all. We’ve made our query too specific. It turns out that the actual title of the movie according to IMDB is Star Wars: Episode V - The Empire Strikes Back. Let’s soften our query by searching for the phrase The Empire Strikes Back within the title. We can do this using the LIKE function along with some wildcards (% in SQL).
```{sql connection = db}
SELECT *
FROM title
WHERE title LIKE '%The Empire Strikes Back%'
AND kind_id = 1;
```

```{sql connection =db}
SELECT t.title, t.production_year
FROM title t 
WHERE t.title LIKE '%The Empire Strikes Back%'
  AND t.kind_id = 1
ORDER BY production_year;
```

